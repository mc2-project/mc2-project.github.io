<!doctype html>
<html class="no-js">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" /><link rel="next" title="CLI Reference" href="api.html" /><link rel="prev" title="CLI Interface" href="index.html" />

    <link rel="shortcut icon" href="../../_static/favicon.png"/><meta name="generator" content="sphinx-4.2.0, furo 2021.09.22"/>
        <title>CLI Usage - MC2 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?digest=150e365fa939648e89c22f6d7d13c72a1657915a" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?digest=16fb25fabf47304eee183a5e9af80b1ba98259b1" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  --color-brand-primary: #00B0FF;
  --color-brand-content: #00B0FF;
  --color-admonition-background: orange;
  
  }
  body[data-theme="dark"] {
    --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
  }
  @media (prefers-color-scheme: dark) {
    body:not([data-theme="light"]) {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
  }
</style></head>
  <body>
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" />
      <line x1="4" y1="6" x2="20" y2="6" />
      <line x1="10" y1="12" x2="20" y2="12" />
      <line x1="6" y1="18" x2="20" y2="18" />
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">MC<sup>2</sup>  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand centered" href="../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../../_static/logo.png" alt="Logo"/>
  </div>
  
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../index.html">What is MC²?</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../../documentation.html">Documentation</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 current has-children"><a class="reference internal" href="../index.html">MC² Client</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quickstart.html">Quickstart</a></li>
<li class="toctree-l3"><a class="reference internal" href="../opaquesql_usage.html">Usage with Opaque SQL</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../config/index.html">Configuration</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../config/config.html">Global Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../config/azure.html">Azure Configuration</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../python/index.html">Python Interface</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../python/usage.html">Python Package Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../python/api.html">API Reference</a></li>
</ul>
</li>
<li class="toctree-l3 current has-children"><a class="reference internal" href="index.html">CLI Interface</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l4 current current-page"><a class="current reference internal" href="#">CLI Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html">CLI Reference</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../opaque-sql-docs/src/index.html">Opaque SQL</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../opaque-sql-docs/src/install/install.html">Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../opaque-sql-docs/src/usage/client.html">Query submission via the MC<sup>2</sup> Client</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../opaque-sql-docs/src/usage/untrusted.html">Query submission via the Spark Driver</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../opaque-sql-docs/src/usage/usage.html">Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../opaque-sql-docs/src/usage/functionality.html">Supported functionalities</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../opaque-sql-docs/src/benchmarking/benchmarking.html">Benchmarking</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../opaque-sql-docs/src/contributing/contributing.html">Contributing</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/mc2-project/mc2">GitHub</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../resources.html">Resources</a></li>
</ul>

</div>
</div>
      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <div class="content-icon-container">
          <div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="cli-usage">
<h1>CLI Usage<a class="headerlink" href="#cli-usage" title="Permalink to this headline">¶</a></h1>
<p>Below, you’ll find guides on how to use the MC<sup>2</sup> Client command line interface. The CLI is dependent on the <code class="code docutils literal notranslate"><span class="pre">mc2client</span></code> Python package, so ensure that you’ve first installed the Python package by trying to import <code class="code docutils literal notranslate"><span class="pre">python-package</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span> <span class="kn">import</span> <span class="nn">mc2client</span> <span class="k">as</span> <span class="nn">mc2</span>
</pre></div>
</div>
<p>The CLI relies heavily on a configuration file in which you can specify the parameters for each command as explained in the next section.</p>
<section id="configuring-platform-client">
<h2>Configuring MC<sup>2</sup> Client<a class="headerlink" href="#configuring-platform-client" title="Permalink to this headline">¶</a></h2>
<p>Before running anything, you’ll need to create a configuration YAML file specifying certain parameters. More on configuration is <a class="reference internal" href="../config/config.html"><span class="doc">here</span></a>.</p>
<p>Once you’ve populated a YAML file with your desired parameters, configure MC<sup>2</sup> Client with the path to your configuration file.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span> <span class="c1"># An example config is at `demo/config.yaml`</span>
 mc2 configure /path/to/config/yaml
</pre></div>
</div>
</section>
<section id="generating-keys">
<h2>Generating Keys<a class="headerlink" href="#generating-keys" title="Permalink to this headline">¶</a></h2>
<p>If you don’t already have a keypair and/or a symmetric key, you’ll want to generate them so that you can interact with MC<sup>2</sup> cloud compute services in a cryptographically secure manner. MC<sup>2</sup> uses your keypair to authenticate you to MC<sup>2</sup> compute services, and uses your symmetric key to encrypt your data to ensure that the cloud doesn’t see it in plaintext..</p>
<p>You can generate a keypair, corresponding certificate, and a symmetric key through the CLI. You should have specified paths for your private key, public key, certificate, and symmetric key during configuration. If something already exists at either the private key, public key, or certificate path, MC<sup>2</sup> Client will skip generating the keypair and corresponding certificate. If something already exists at the symmetric key path, MC<sup>2</sup> Client will skip generating the symmetric key.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span> <span class="c1"># Generate a keypair, corresponding certificate, and symmetric key</span>
 <span class="c1"># If something exists at any paths specified in the config,</span>
 <span class="c1"># MC2 Client will skip generation.</span>
 $ mc2 init
</pre></div>
</div>
<p><em>Note that, by default, |platform| Client uses a pre-generated RSA public key for enclave verification. This key should be not be used in a production environment.</em></p>
</section>
<section id="launching-cloud-resources">
<h2>Launching Cloud Resources<a class="headerlink" href="#launching-cloud-resources" title="Permalink to this headline">¶</a></h2>
<p>You can use MC<sup>2</sup> Client to launch resources in Azure. In particular, you can create a cluster of VMs, Azure blob storage, and a storage container. This section in the configuration looks as follows.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">launch</span><span class="p">:</span>
   <span class="c1"># The absolute path to your Azure configuraton</span>
   <span class="c1"># This needs to be an absolute path</span>
   <span class="nt">azure_config</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/path/to/azure.yaml</span>

   <span class="c1"># Whether to launch a cluster of VMs</span>
   <span class="nt">cluster</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nv">true</span><span class="p p-Indicator">,</span> <span class="nv">false</span><span class="p p-Indicator">}</span>

   <span class="c1"># Whether to launch Azure blob storage</span>
   <span class="nt">storage</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nv">true</span><span class="p p-Indicator">,</span> <span class="nv">false</span><span class="p p-Indicator">}</span>

   <span class="c1"># Whether to launch a storage container</span>
   <span class="nt">container</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nv">true</span><span class="p p-Indicator">,</span> <span class="nv">false</span><span class="p p-Indicator">}</span>
</pre></div>
</div>
<p>You will also need to specify details for the Azure resources you want to launch in a separate configuration file. An example of the file can be found in <code class="docutils literal notranslate"><span class="pre">demo/azure.yaml</span></code>.</p>
<p>In particular, note the following important sections in the Azure configuration that you will likely want to modify.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># An unique identifier for the head node and workers of this cluster.</span>
<span class="nt">cluster_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">default</span>

<span class="c1"># The total number of workers nodes to launch in addition to the head</span>
<span class="c1"># node. This number should be &gt;= 0.</span>
<span class="nt">num_workers</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0</span>

<span class="c1"># Cloud-provider specific configuration.</span>
<span class="nt">provider</span><span class="p">:</span>
   <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">azure</span>

   <span class="c1"># Location of resources</span>
   <span class="nt">location</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">eastus</span>

   <span class="c1"># Name of resource group that will contain your launched resources</span>
   <span class="nt">resource_group</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">mc2-client-dev</span>

   <span class="c1"># Name of Azure blob storage you want to create</span>
   <span class="nt">storage_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">mc2storage</span>

   <span class="c1"># Name of storage container you want to create</span>
   <span class="nt">container_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">blob-container-1</span>

   <span class="c1"># If left blank, the default subscription ID from Azure CLI will be used</span>
   <span class="nt">subscription_id</span><span class="p">:</span>

<span class="c1"># How MC2 will authenticate with newly launched nodes.</span>
<span class="nt">auth</span><span class="p">:</span>
   <span class="c1"># The username used to SSH into created VMs</span>
   <span class="nt">ssh_user</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">mc2</span>

   <span class="c1"># you must specify paths to matching private and public key pair files</span>
   <span class="c1"># use `ssh-keygen -t rsa -b 4096` to generate a new ssh key pair</span>
   <span class="nt">ssh_private_key</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">~/.ssh/id_rsa</span>
   <span class="nt">ssh_public_key</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">~/.ssh/id_rsa.pub</span>
</pre></div>
</div>
<p>To launch the resources, run the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mc2 launch
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If nodes have been manually configured (via the <code class="docutils literal notranslate"><span class="pre">head</span></code> or <code class="docutils literal notranslate"><span class="pre">workers</span></code> fields in the <code class="docutils literal notranslate"><span class="pre">launch</span></code> section), this command will not do anything.</p>
</div>
</section>
<section id="starting-compute-services-remotely">
<h2>Starting Compute Services Remotely<a class="headerlink" href="#starting-compute-services-remotely" title="Permalink to this headline">¶</a></h2>
<p>To run computation, you’ll need to remotely start the compute services. You can specify commands to start the compute services using MC<sup>2</sup> Client through configuration. MC<sup>2</sup> Client will remotely run these commands on each VM in the Azure cluster.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">start</span><span class="p">:</span>
   <span class="c1"># Commands to run on head node</span>
   <span class="nt">head</span><span class="p">:</span>
   <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">echo "Hello from head"</span>

   <span class="c1"># Commands to run on worker nodes</span>
   <span class="nt">workers</span><span class="p">:</span>
   <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">echo "Hello from worker"</span>
</pre></div>
</div>
<p>To start the services, run the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mc2 start
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If nodes have been manually configured (via the <code class="docutils literal notranslate"><span class="pre">head</span></code> or <code class="docutils literal notranslate"><span class="pre">workers</span></code> fields in the <code class="docutils literal notranslate"><span class="pre">launch</span></code> section) and are locally hosted (i.e. <code class="docutils literal notranslate"><span class="pre">ip</span></code> is <code class="docutils literal notranslate"><span class="pre">0.0.0.0</span></code> or <code class="docutils literal notranslate"><span class="pre">127.0.0.1</span></code>) then the commands will be run in a local subprocess.</p>
</div>
</section>
<section id="encrypting-and-uploading-data">
<h2>Encrypting and Uploading Data<a class="headerlink" href="#encrypting-and-uploading-data" title="Permalink to this headline">¶</a></h2>
<p>MC<sup>2</sup> Client will use the symmetric key you specified during configuration to encrypt your sensitive data. If you don’t yet have a symmetric key, see the above section on <a class="reference internal" href="#generating-keys"><span class="std std-ref">Generating Keys</span></a>.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">upload</span><span class="p">:</span>
   <span class="c1"># Whether to upload data to Azure blob storage or disk</span>
   <span class="c1"># Allowed values are `blob` or `disk`</span>
   <span class="c1"># If `blob`, Azure CLI will be called to upload data</span>
   <span class="c1"># Else, `scp` will be used</span>
   <span class="nt">storage</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nv">blob</span><span class="p p-Indicator">,</span> <span class="nv">disk</span><span class="p p-Indicator">}</span>

   <span class="c1"># Encryption format to use</span>
   <span class="c1"># Options are `sql` if you want to use Opaque SQL</span>
   <span class="c1"># or `xgb` if you want to use Secure XGBoost</span>
   <span class="nt">format</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nv">sql</span><span class="p p-Indicator">,</span> <span class="nv">xgb</span><span class="p p-Indicator">}</span>

   <span class="c1"># Files to encrypt and upload</span>
   <span class="nt">src</span><span class="p">:</span>
     <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">/path/to/your/data.csv</span>

   <span class="c1"># If you want to run Opaque SQL, you must also specify a schema,</span>
   <span class="c1"># one for each file you want to encrypt and upload</span>
   <span class="nt">schemas</span><span class="p">:</span>
   <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">/path/to/opaquesql_schema.json</span>

   <span class="c1"># Directory to upload data to</span>
   <span class="nt">dst</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">dst_dir</span>
</pre></div>
</div>
<p>To encrypt and upload your data, run the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mc2 upload
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If nodes have been manually configured (via the <code class="docutils literal notranslate"><span class="pre">head</span></code> or <code class="docutils literal notranslate"><span class="pre">workers</span></code> fields in the <code class="docutils literal notranslate"><span class="pre">launch</span></code> section) and are locally hosted (i.e. <code class="docutils literal notranslate"><span class="pre">ip</span></code> is <code class="docutils literal notranslate"><span class="pre">0.0.0.0</span></code> or <code class="docutils literal notranslate"><span class="pre">127.0.0.1</span></code>) then the file will be copied to <code class="docutils literal notranslate"><span class="pre">dst</span></code> on the local machine.</p>
</div>
<section id="note-on-sql-format">
<span id="sqlformat"></span><h3>Note on <code class="docutils literal notranslate"><span class="pre">sql</span></code> Format<a class="headerlink" href="#note-on-sql-format" title="Permalink to this headline">¶</a></h3>
<p>If you plan on using the MC<sup>2</sup> compute service, you’ll want to encrypt your data in <code class="docutils literal notranslate"><span class="pre">sql</span></code> format. For this format, you’ll first need to create a file specifying the schema of the data.</p>
<p>The schema must be written in the following format:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>col_1_name:col_1_type,col_2_name:col_2_type,col_3_name:col_3_type
</pre></div>
</div>
<p>For example, if your data has 3 columns, named <code class="docutils literal notranslate"><span class="pre">age</span></code> of type <code class="docutils literal notranslate"><span class="pre">integer</span></code>, <code class="docutils literal notranslate"><span class="pre">rank</span></code> of type <code class="docutils literal notranslate"><span class="pre">float</span></code>, and <code class="docutils literal notranslate"><span class="pre">animal</span></code> of type <code class="docutils literal notranslate"><span class="pre">string</span></code>, the schema would look like the following:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>age:integer,rank:float,animal:string
</pre></div>
</div>
<p>Currently, MC<sup>2</sup> supports the following types:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">integer</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">long</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">float</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">double</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">string</span></code></p></li>
</ul>
<p>If the data in your column is not of any of these types, MC<sup>2</sup> Client will by default encrypt it as a string type.</p>
</section>
</section>
<section id="running-computation">
<h2>Running Computation<a class="headerlink" href="#running-computation" title="Permalink to this headline">¶</a></h2>
<p>To run computation, you should specify a script to run in the configuration. In addition, when you initiate computation, MC<sup>2</sup> Client will under the hood attest the enclave deployment before actually running the computation. Attestation ensures that all enclaves were built and loaded with the proper code and that they were properly initialized. You will also need to specify some configuration values for attestation.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># Computation configuration</span>
<span class="nt">run</span><span class="p">:</span>
   <span class="c1"># Script to run</span>
   <span class="nt">script</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">opaque_sql_demo.scala</span>

   <span class="c1"># Compute service you're using</span>
   <span class="c1"># Choices are `xgb` or `sql`</span>
   <span class="nt">compute</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nv">xgb</span><span class="p p-Indicator">,</span> <span class="nv">sql</span><span class="p p-Indicator">}</span>

   <span class="c1"># Attestation configuration</span>
   <span class="nt">attestation</span><span class="p">:</span>
      <span class="c1"># Whether we are running in simulation mode</span>
      <span class="c1"># If 0 (False), we are _not_ running in simulation mode,</span>
      <span class="c1"># and should verify the attestation evidence</span>
      <span class="nt">simulation_mode</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nv">0</span><span class="p p-Indicator">,</span> <span class="nv">1</span><span class="p p-Indicator">}</span>

      <span class="c1"># Path to MRENCLAVE value to check</span>
      <span class="c1"># MRENCLAVE is a hash of the enclave build log</span>
      <span class="nt">mrenclave</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">NULL</span>

      <span class="c1"># Path to MRSIGNER value to check</span>
      <span class="c1"># MRSIGNER is the key used to sign the built enclave</span>
   <span class="-Error">  </span><span class="nt">mrsigner</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">${MC2_CLIENT_HOME}/python-package/tests/keys/mc2_test_key.pub</span>

   <span class="c1"># The client consortium. Each username is mapped to a public key and</span>
   <span class="c1"># release policy</span>
   <span class="nt">consortium</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">username</span><span class="p">:</span>
        <span class="nt">public_key</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/path/to/user/public/key</span>
        <span class="nt">release_policy</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nv">true</span><span class="p p-Indicator">,</span><span class="nv">false</span><span class="p p-Indicator">}</span>
</pre></div>
</div>
<p>Begin computation by running the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mc2 run
</pre></div>
</div>
</section>
<section id="downloading-and-decrypting-data">
<h2>Downloading and Decrypting Data<a class="headerlink" href="#downloading-and-decrypting-data" title="Permalink to this headline">¶</a></h2>
<p>MC<sup>2</sup> Client will use the symmetric key you specified during configuration to decrypt computation results. If you don’t yet have a symmetric key, see the above section on <a class="reference internal" href="#generating-keys"><span class="std std-ref">Generating Keys</span></a>. You should download results from where the compute services saved the results.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># Configuration for downloading results</span>
<span class="nt">download</span><span class="p">:</span>
    <span class="c1"># Whether to upload data to Azure blob storage or disk</span>
    <span class="c1"># Allowed values are `blob` or `disk`</span>
    <span class="c1"># If `blob`, Azure CLI will be called to upload data</span>
    <span class="c1"># Else, `scp` will be used</span>
    <span class="nt">storage</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nv">blob</span><span class="p p-Indicator">,</span> <span class="nv">disk</span><span class="p p-Indicator">}</span>

    <span class="c1"># Format this data is encrypted with</span>
    <span class="nt">format</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nv">xgb</span><span class="p p-Indicator">,</span> <span class="nv">sql</span><span class="p p-Indicator">}</span>

    <span class="c1"># Directory/file to download</span>
    <span class="nt">src</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">securexgb_train.csv.enc</span>

    <span class="c1"># Local directory to download data to</span>
    <span class="nt">dst</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">results/</span>
</pre></div>
</div>
<p>To encrypt and upload your data, run the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mc2 download
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If nodes have been manually configured (via the <code class="docutils literal notranslate"><span class="pre">head</span></code> or <code class="docutils literal notranslate"><span class="pre">workers</span></code> fields in the <code class="docutils literal notranslate"><span class="pre">launch</span></code> section) and are locally hosted (i.e. <code class="docutils literal notranslate"><span class="pre">ip</span></code> is <code class="docutils literal notranslate"><span class="pre">0.0.0.0</span></code> or <code class="docutils literal notranslate"><span class="pre">127.0.0.1</span></code>) then the file will be copied from <code class="docutils literal notranslate"><span class="pre">src</span></code> to <code class="docutils literal notranslate"><span class="pre">dst</span></code> on the local machine.</p>
</div>
</section>
<section id="stopping-compute-services">
<h2>Stopping Compute Services<a class="headerlink" href="#stopping-compute-services" title="Permalink to this headline">¶</a></h2>
<p>Not implemented</p>
</section>
<section id="terminating-azure-resources">
<h2>Terminating Azure Resources<a class="headerlink" href="#terminating-azure-resources" title="Permalink to this headline">¶</a></h2>
<p>You can use MC<sup>2</sup> Client to terminate your launched Azure resources. Specify which resources you want to terminate in the configuration.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">teardown</span><span class="p">:</span>
   <span class="c1"># Whether to terminate launched VMs</span>
   <span class="nt">cluster</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nv">true</span><span class="p p-Indicator">,</span> <span class="nv">false</span><span class="p p-Indicator">}</span>

   <span class="c1"># Whether to terminate created Azure blob storage</span>
   <span class="nt">storage</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nv">true</span><span class="p p-Indicator">,</span> <span class="nv">false</span><span class="p p-Indicator">}</span>

   <span class="c1"># Whether to terminate created storage container</span>
   <span class="nt">container</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nv">true</span><span class="p p-Indicator">,</span> <span class="nv">false</span><span class="p p-Indicator">}</span>
</pre></div>
</div>
<p>To terminate desired resources, run the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mc2 teardown
</pre></div>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="api.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">CLI Reference</div>
              </div>
              <svg><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="index.html">
              <svg><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">CLI Interface</div>
                
              </div>
            </a>
        </div>

        <div class="related-information">
              Copyright &#169; 2021, MC² Contributors |
            Built with <a href="https://www.sphinx-doc.org/">Sphinx</a>
              and
              <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
              <a href="https://github.com/pradyunsg/furo">Furo theme</a>. |
            <a class="muted-link" href="../../_sources/client-docs/cli/usage.rst.txt"
               rel="nofollow">
              Show Source
            </a>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            Contents
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">CLI Usage</a><ul>
<li><a class="reference internal" href="#configuring-platform-client">Configuring MC<sup>2</sup> Client</a></li>
<li><a class="reference internal" href="#generating-keys">Generating Keys</a></li>
<li><a class="reference internal" href="#launching-cloud-resources">Launching Cloud Resources</a></li>
<li><a class="reference internal" href="#starting-compute-services-remotely">Starting Compute Services Remotely</a></li>
<li><a class="reference internal" href="#encrypting-and-uploading-data">Encrypting and Uploading Data</a><ul>
<li><a class="reference internal" href="#note-on-sql-format">Note on <code class="docutils literal notranslate"><span class="pre">sql</span></code> Format</a></li>
</ul>
</li>
<li><a class="reference internal" href="#running-computation">Running Computation</a></li>
<li><a class="reference internal" href="#downloading-and-decrypting-data">Downloading and Decrypting Data</a></li>
<li><a class="reference internal" href="#stopping-compute-services">Stopping Compute Services</a></li>
<li><a class="reference internal" href="#terminating-azure-resources">Terminating Azure Resources</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/scripts/main.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    </body>
</html>